<div class="modal-header">
	<button type="button" class="close" aria-label="Close"><span aria-hidden="true" ng-click="$dismiss()">&times;</span></button>
	<h4 class="modal-title">{{task.subject}} <span class="stream">in stream <strong>{{ task.stream.subject }}</strong></span></h4>
</div>
<div class="modal-body">
	<div class="row">
		<div class="col-md-9">
			<table class="table table-striped">
				<thead>
					<tr>
						<th style="text-align: left">Members</th>
						<th style="text-align: right">Estimate</th>
						<th style="text-align: center" ng-if="task.status == 50">Avg</th>
						<th style="text-align: center" ng-if="task.status == 50">&Delta;</th>
						<th style="width: 1px"></th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="member in task.members">
						<th>
							<img ng-src="{{ member.picture }}" style="max-width: 30px; max-height: 30px;" class="img-circle">
							<span class="firstname">{{ member.firstname }}</span>
							<span class="lastname">{{ member.lastname }}</span>
							<span ng-if="member.role == 'owner'">(o)</span>
						</th>
						<td style="text-align: right; vertical-align: middle">
							<span ng-if="member.estimation.value == -2" class="glyphicon glyphicon-ok" aria-hidden="true"></span>
							<span ng-if="member.estimation.value == -1">Skipped</span>
							<span ng-if="member.estimation.value >= 0">
								{{ member.estimation.value | number : 0 }}
								<button type="button" class="btn btn-default" style="padding: 0; background: transparent; border: 0 none" ng-if="task.status < 30">
									<span class="glyphicon glyphicon-edit"></span>
								</button>
							</span>
						</td>
						<td style="text-align: center; vertical-align: middle" ng-if="member.share">{{ member.share * 100 | number : 2 }}</td>
						<td style="text-align: center; vertical-align: middle" ng-if="member.delta">{{ member.delta * 100 | number : 2 }}</td>
						<td style="vertical-align: middle">
							<button title="Unjoin Item" class="btn btn-default" ng-if="member.id == currUser.id && isAllowed.unjoinTask(task)" ng-click="unjoinTask(task)" style="padding: 0; background: transparent; border: 0 none">
								<span class="glyphicon glyphicon-minus-sign" style="color: red"></span>
							</button>
						</td>
					</tr>
				</tbody>
			</table>
			<ul class="activity-list">
				<li><strong>{{ task.createdBy }}</strong> created this item {{ daysAgo(task.createdAt) }} days ago. <span class="timestamp">{{ task.createdAt | date : 'short' }}</span></li>
			</ul>
		</div>
		<div class="col-md-3">
			<div class="status">
				<span ng-class="statusClass()">{{ { 10: 'Ongoing', 20: 'Completed' }[task.status] }}</span>
			</div>
			<div class="estimation">
				<span class="estimation-header">Estimation</span>
				<span class="estimation-value">
					<span ng-if="task.estimation == null">In progress</span>
					<span ng-if="task.estimation == -1">Skipped</span>
					<span ng-if="task.estimation >= 0 && task.estimation !== null">{{ task.estimation | number : 0 }} Credits</span>
				</span>
			</div>
		</div>
	</div>
</div>
<div class="modal-footer">
	<div class="btn-group" dropdown is-open="status.isopen">
		<button class="btn btn-default dropdown-toggle" dropdown-toggle ng-disabled="disabled" aria-expanded="false">
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu dropdown-menu-right" role="menu">
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#" ng-click="editTask(task.id)">Edit</a></li>
			<li role="presentation"><a role="menuitem" tabindex="-1" href="#" ng-click="deleteTask(task.id)">Delete</a></li>
		</ul>
	</div>
	<button class="btn btn-primary" ng-if="acl.isAllowed(currUser, task, 'joinTask')" ng-click="joinTask()">Join</button>
</div>